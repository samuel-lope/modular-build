<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Projeto 2D Interativo</title>
    <link href="css/build.css" rel="stylesheet">
    <link href="css/style.css" rel="stylesheet" >
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body class="bg-gray-800 text-white font-sans overflow-hidden">

    <div id="scene-container" class="relative w-screen h-screen">
        <div id="scene" class="w-full h-full bg-gray-700 relative overflow-hidden">
            <!-- Objetos 2D serão adicionados aqui via JS -->
        </div>

        <!-- Botões do Canto Superior Direito -->
        <div class="absolute top-4 right-4 flex items-center gap-2 z-10">
            <input type="file" id="import-json-input" accept=".json" class="hidden">
            <label for="import-json-input" id="import-json-btn" class="p-3 bg-green-600 hover:bg-green-700 rounded-lg shadow-md transition-colors font-semibold cursor-pointer">
                <!-- O ícone será inserido via JS -->
            </label>
            <button id="download-json-btn" class="p-3 bg-blue-600 hover:bg-blue-700 rounded-lg shadow-md transition-colors font-semibold">
                <!-- O ícone será inserido via JS -->
            </button>
            <button id="manage-objects-btn" class="p-3 bg-gray-600 hover:bg-gray-500 rounded-lg shadow-md transition-colors font-semibold">
                <!-- O ícone será inserido via JS -->
            </button>
            <button id="clear-scene-btn" title="Limpar Cena" class="p-3 bg-red-600 hover:bg-red-700 rounded-lg shadow-md transition-colors font-semibold">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-trash-2"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path><line x1="10" y1="11" x2="10" y2="17"></line><line x1="14" y1="11" x2="14" y2="17"></line></svg>
            </button>
        </div>

        <!-- Controles da UI -->
        <div id="ui-controls" class="absolute top-4 left-4 flex flex-col space-y-2">
            <!-- Container para os botões de adicionar objetos, que serão gerados dinamicamente -->
            <div id="add-buttons-container" class="flex flex-wrap items-center gap-2 z-10">
                 <!-- Botões de adicionar são inseridos aqui via JS -->
            </div>
             <div class="bg-gray-900 bg-opacity-70 text-sm rounded-lg px-3 py-2 shadow-lg flex items-center space-x-4">
                <span id="coords">(x, y): ...</span>
                <div class="flex items-center space-x-2">
                    <label for="bg-color-picker" class="font-medium">Fundo:</label>
                    <input type="color" id="bg-color-picker" class="w-7 h-7">
                </div>
            </div>
        </div>
    </div>

    <!-- Formulário Modal -->
    <div id="form-container" class="hidden absolute inset-0 bg-black bg-opacity-60 items-center justify-center z-10">
        <div class="bg-gray-800 p-6 rounded-xl shadow-2xl w-full max-w-md border border-gray-700 max-h-[90vh] overflow-y-auto">
            <h2 id="form-title" class="text-2xl font-bold mb-4">Configurar Objeto</h2>
            <form id="object-form" class="space-y-4">
                <input type="hidden" id="object-id">
                <input type="hidden" id="object-type">

                <!-- Campos Comuns -->
                <div>
                    <label for="object-name" class="block text-sm font-medium text-gray-400">Nome</label>
                    <input type="text" id="object-name" class="mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                </div>
                <div>
                    <label for="object-view" class="block text-sm font-medium text-gray-400">Ordem de Exibição (view)</label>
                    <input type="number" id="object-view" placeholder="0" class="mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3">
                </div>
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label for="x" class="block text-sm font-medium text-gray-400">Posição X</label>
                        <input type="number" id="x" class="mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3">
                    </div>
                    <div>
                        <label for="y" class="block text-sm font-medium text-gray-400">Posição Y</label>
                        <input type="number" id="y" class="mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3">
                    </div>
                </div>

                <!-- Campos do Retângulo -->
                <div id="rect-fields" class="hidden space-y-4">
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label for="largura" class="block text-sm font-medium text-gray-400">Largura (px)</label>
                            <input type="number" id="largura" class="mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3">
                        </div>
                        <div>
                            <label for="altura" class="block text-sm font-medium text-gray-400">Altura (px)</label>
                            <input type="number" id="altura" class="mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3">
                        </div>
                    </div>
                     <div>
                        <label for="rotation" class="block text-sm font-medium text-gray-400">Rotação (°)</label>
                        <input type="number" step="any" id="rotation" class="mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3">
                    </div>
                </div>
                
                <!-- Campos do Círculo -->
                <div id="circle-fields" class="hidden space-y-4">
                     <div>
                        <label for="diametro" class="block text-sm font-medium text-gray-400">Diâmetro (px)</label>
                        <input type="number" id="diametro" class="mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3">
                    </div>
                </div>

                <!-- Campos compartilhados por Retângulo e Círculo -->
                 <div id="shape-common-fields" class="hidden space-y-4">
                     <div class="grid grid-cols-2 gap-4">
                         <div>
                             <label for="cor" class="block text-sm font-medium text-gray-400">Cor Padrão (RGBA)</label>
                             <input type="text" id="cor" value="rgba(59, 130, 246, 1)" class="mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3">
                         </div>
                         <div>
                             <label for="cor-colisao" class="block text-sm font-medium text-gray-400">Cor Colisão (RGBA)</label>
                             <input type="text" id="cor-colisao" value="rgba(239, 68, 68, 1)" class="mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3">
                         </div>
                     </div>
                     <div class="flex items-center">
                         <input type="checkbox" id="reacts-to-collision" class="h-4 w-4 text-blue-600 bg-gray-700 border-gray-600 rounded focus:ring-blue-500">
                         <label for="reacts-to-collision" class="ml-2 block text-sm">Reage à colisão</label>
                     </div>
                     <div class="flex items-center">
                        <input type="checkbox" id="is-obstacle" class="h-4 w-4 text-blue-600 bg-gray-700 border-gray-600 rounded focus:ring-blue-500">
                        <label for="is-obstacle" class="ml-2 block text-sm">É uma barreira (intransponível)</label>
                    </div>
                 </div>

                <!-- Campos do Slider -->
                <div id="slider-fields" class="hidden space-y-4">
                    <!-- **NOVO**: Dropdown para herança de valor -->
                    <div>
                        <label for="inherit-slider" class="block text-sm font-medium text-gray-400">Herdar valor do Slider</label>
                        <select id="inherit-slider" class="mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3"></select>
                    </div>
                    <div class="pt-4 border-t border-gray-600">
                        <label for="target-object" class="block text-sm font-medium text-gray-400">Controlar Objeto (Alvo)</label>
                        <select id="target-object" class="mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3"></select>
                    </div>
                    <div>
                        <label for="target-property" class="block text-sm font-medium text-gray-400">Propriedade Alvo</label>
                        <select id="target-property" class="mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3">
                            <option value="x">Posição X</option>
                            <option value="y">Posição Y</option>
                            <option value="largura">Largura</option>
                            <option value="altura">Altura</option>
                             <option value="diametro">Diâmetro</option>
                            <option value="rotation">Rotação</option>
                        </select>
                    </div>
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label for="min-value" class="block text-sm font-medium text-gray-400">Valor Mínimo</label>
                            <input type="number" id="min-value" value="0" class="mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3">
                        </div>
                        <div>
                            <label for="max-value" class="block text-sm font-medium text-gray-400">Valor Máximo</label>
                            <input type="number" id="max-value" value="500" class="mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3">
                        </div>
                    </div>
                </div>
                
                <!-- Campos do Condicional -->
                <div id="conditional-fields" class="hidden space-y-4 pt-4 border-t border-gray-600">
                    <h3 class="text-lg font-semibold text-yellow-500">Lógica Condicional</h3>
                    <div>
                        <label for="condition-target" class="block text-sm font-medium text-gray-400">Se o objeto...</label>
                        <select id="condition-target" class="mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3"></select>
                    </div>
                    <div class="grid grid-cols-3 gap-3 items-end">
                        <div>
                            <label for="condition-property" class="block text-sm font-medium text-gray-400">...tiver a prop.</label>
                            <select id="condition-property" class="mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3">
                                <option value="x">Posição X</option>
                                <option value="y">Posição Y</option>
                                <option value="largura">Largura</option>
                                <option value="altura">Altura</option>
                                <option value="diametro">Diâmetro</option>
                            </select>
                        </div>
                        <div>
                           <label for="condition-operator" class="block text-sm font-medium text-gray-400">...for</label>
                           <select id="condition-operator" class="mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3">
                                <option value="==">Igual a</option>
                                <option value="!=">Diferente de</option>
                                <option value=">">Maior que</option>
                                <option value="<">Menor que</option>
                                <option value=">=">Maior ou Igual a</option>
                                <option value="<=">Menor ou Igual a</option>
                            </select>
                        </div>
                        <div>
                            <label for="condition-value" class="block text-sm font-medium text-gray-400">...valor</label>
                            <input type="number" id="condition-value" class="mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3">
                        </div>
                    </div>
                    
                    <div>
                        <label for="transformation-type" class="block text-sm font-medium text-gray-400">Então, este objeto irá...</label>
                        <select id="transformation-type" class="mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3">
                            <option value="changeColor">Mudar de Cor</option>
                            <option value="changePosition">Mudar de Posição</option>
                        </select>
                    </div>

                    <div id="transformation-value-container">
                        <!-- Campos de valor da transformação serão injetados aqui via JS -->
                    </div>
                </div>

                <!-- Campos do RX-Serial -->
                <div id="rx-serial-fields" class="hidden space-y-4 pt-4 border-t border-gray-600">
                    <h3 class="text-lg font-semibold text-cyan-400">Configuração Serial (RX)</h3>
                    <div>
                        <label for="target-slider" class="block text-sm font-medium text-gray-400">Controlar o Slider</label>
                        <select id="target-slider" class="mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3"></select>
                    </div>
                     <div>
                        <label for="baud-rate" class="block text-sm font-medium text-gray-400">Baud Rate</label>
                        <input type="number" id="baud-rate" value="9600" class="mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3">
                    </div>
                </div>

                <!-- Botões de Ação -->
                <div class="flex justify-between items-center pt-4">
                    <div>
                        <button type="button" id="delete-btn" class="px-4 py-2 bg-red-600 hover:bg-red-700 rounded-md font-medium">Excluir</button>
                    </div>
                    <div>
                        <button type="button" id="cancel-btn" class="px-4 py-2 bg-gray-600 hover:bg-gray-500 rounded-md font-medium mr-2">Cancelar</button>
                        <button type="submit" class="px-4 py-2 bg-blue-600 hover:bg-blue-700 rounded-md font-medium">Salvar</button>
                    </div>
                </div>
            </form>
        </div>
    </div>
    
    <!-- Tabela Modal -->
    <div id="table-modal-container" class="hidden absolute inset-0 bg-black bg-opacity-70 items-center justify-center z-50">
        <div class="bg-gray-800 p-6 rounded-xl shadow-2xl w-full max-w-6xl border border-gray-700 flex flex-col">
            <div class="flex justify-between items-center mb-4">
                <div class="flex items-center gap-4">
                    <h2 class="text-2xl font-bold">Gerenciador de Objetos</h2>
                    <button id="group-selected-btn" class="px-4 py-2 bg-green-600 hover:bg-green-700 rounded-md font-medium disabled:bg-gray-500 disabled:cursor-not-allowed">Agrupar Selecionados</button>
                </div>
                <button id="close-table-btn" class="text-gray-400 hover:text-white text-3xl font-bold">&times;</button>
            </div>
            <div class="overflow-auto max-h-[70vh]">
                <table id="objects-table" class="w-full text-sm text-left table-auto">
                    <thead class="text-xs text-gray-400 uppercase bg-gray-700 sticky top-0">
                        <tr>
                            <th class="px-4 py-3 w-12"></th> <!-- Para Checkbox -->
                            <!-- Outros headers serão gerados via JS -->
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Linhas serão geradas via JS -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>


    <script type="module" src="js/main.js"></script>
</body>
</html>

